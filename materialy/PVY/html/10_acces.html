<h3 id="10-pr-ce-v-datab-zov-m-programu">Práce v databázovém programu</h3>
<h4 id="co-je-to-datab-ze-">Co je to databáze?</h4>
<p><a href="pictures/PVY_okruhy/10_databazovy-program/10_1_datova-zakladna.PNG" alt="Databáze"></a></p>
<blockquote>
<p>„Je to strukturovaná množina dat uložená v počítači“</p>
</blockquote>
<h4 id="d-le-it-fakta-o-datab-zi-">Důležitá fakta o databázi:</h4>
<ul>
<li><p>předchůdcem databáze byla kartotéka</p>
</li>
<li><p>kolem roku 1974 vzniká první dotazovací jazyk používaný v databázích – <em>SQL</em></p>
</li>
<li><p>díky SQL jazyku se na databáze pohlíží jako na tabulky – relační databáze</p>
</li>
<li><p>entity (tabulky) jsou mezi sebou propojeny relacemi pomocí <em>primárních</em> a <em>cizích klíčů</em></p>
</li>
</ul>
<h4 id="tvorba-db-z-kladn-fakta-">Tvorba DB – základní fakta:</h4>
<ul>
<li><p>existují tři typy relací:</p>
<ul>
<li>1:1 </li>
<li>1:n</li>
<li>m:n</li>
</ul>
</li>
<li><p>při vytváření databáze musí být zachována referenční integrita</p>
</li>
<li><p>databáze by neměla obsahovat nadbytečné prvky – redundance</p>
</li>
</ul>
<h4 id="rozlo-en-accessu">Rozložení Accessu</h4>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_2_rozlozeni_Accessu.PNG" alt="Rozložení Accessu"></a></p>
<h5 id="relace-v-accessu-obecn-v-db-">Relace v Accessu (obecně v DB)</h5>
<blockquote>
<p>„Relace je vztah mezi dvěma tabulkami v relační databázi“</p>
</blockquote>
<h4 id="typy-relac-">Typy relací:</h4>
<ul>
<li><h4 id="1-1">1:1</h4>
<pre><code class="lang-sh">  <span class="hljs-keyword">Jednomu </span>záznamu v tabulce odpovídá přesně <span class="hljs-keyword">jeden </span>záznam v druhé tabulce.
</code></pre>
<p>  Většinou se jedná o nevhodně navrženou databázi, protože v drtivě většině případů lze 2 entity spojené touto relací sloučit do jedné entity.</p>
<p>  Příklad:     Jméno x Rodné číslo*
  Jeden člověk má pouze jedno rodné číslo a pod jedním rodným číslem může být zapsán pouze jeden člověk</p>
</li>
<li><h4 id="1-n">1:n</h4>
<pre><code class="lang-sh"> Jednomu záznamu v tabulce odpovídá několik záznamů v druhé tabulce.
</code></pre>
<p>  Jedná se o nejpoužívanější typ relace v rozsáhlých databázích.</p>
<p>  Příklad:     Spisovatel x Kniha
  Jeden spisovatel může napsat více knih, avšak jedna jediná kniha může být napsána pouze od jednoho autora.</p>
</li>
</ul>
<ul>
<li><h4 id="m-n">m:n</h4>
<pre><code class="lang-sh">  Ví<span class="hljs-keyword">ce</span> <span class="hljs-keyword">z</span>áznamů<span class="hljs-keyword">m</span> v jedné tabulce odpovídá ví<span class="hljs-keyword">ce</span> <span class="hljs-keyword">z</span>áznamů <span class="hljs-keyword">ve</span> druhé tabulce.
</code></pre>
<p>  V databázi nemůžeme vytvářet přímo entity spojené touto relací. Potřebujeme vytvořit pomocnou tabulku, která bude spojovat tyto entity <em>vazbami 1:n</em>.</p>
<p>  Příklad:     Čtenář x Kniha
  Čtenář může přečíst více knih a zároveň kniha může být přečtena více čtenáři.</p>
</li>
</ul>
<h4 id="import-a-export-dat">Import a export dat</h4>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_3_import-export-dat.PNG" alt="Rozložení Accessu"></a></p>
<h4 id="prim-rn-a-ciz-kl-">Primární a cizí klíč</h4>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_4_prim-a-cizi-klic.PNG" alt="Primární klíč"></a></p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_5_cizi-klic.PNG" alt="Cizí klíč"></a></p>
<h4 id="datov-typy-v-accessu">Datové typy v Accessu</h4>
<h4 id="zde-jsou-vyps-ny-nejpou-van-j-datov-typy-v-datab-zi">Zde jsou vypsány nejpoužívanější datové typy v databázi</h4>
<ul>
<li><h4 id="kr-tk-tex">Krátký tex</h4>
<p>  Klasický typ pro text do 255 znaků. Vhodný pro jakýkoliv zápis kratšího text.</p>
</li>
<li><h4 id="dlouh-text">Dlouhý text</h4>
<p>  Stejný jako předchozí, avšak nemá omezení do 255 znaků. Vhodný pro popisy, nebo životopisy.</p>
</li>
<li><h4 id="-slo">Číslo</h4>
<p>  Pokud potřebujete zapsat číselný záznam. Lze zapsat jak přirozená či celá čísla, tak i čísla desetinná.</p>
</li>
<li><h4 id="datum-a-as">Datum a čas</h4>
<p>  Lze použít několik formátů. Krátké datum bez času (20.12.2019), nebo dlouhé (pátek 20. prosince 2019), čas krátký (20:33), čas dlouhý (20:33:46).</p>
</li>
<li><h4 id="automatick-slo">Automatické číslo</h4>
</li>
</ul>
<p>Používá se u primárních klíčů. Vždy k dalšímu záznamu přičte 1. To znamená že první záznam bude 1, patnáctý záznam bude 15.</p>
<h4 id="vlastnosti-datov-ch-typ-">Vlastnosti datových typů</h4>
<p>V návrhovém zobrazení můžeme u některých datových typů také definovat, jak se záznamy budou zapisovat.</p>
<h5 id="titulek">Titulek</h5>
<p>Zde píšeme název atributu s diakritikou, pro lepší přehlednost.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_6_titulek.PNG" alt="Titulek"></a></p>
<h5 id="vstupn-maska">Vstupní maska</h5>
<p>Lze také definovat masku, podle které zapisujeme data do tabulky (PSČ, telefonní číslo). Můžeme si masku také vytvořit.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_7_vstupni-maska.PNG" alt="Vstupní maska"></a></p>
<h5 id="v-choz-hodnota">Výchozí hodnota</h5>
<p>Výchozí hodnota se převážně používá u dat nebo časů.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_8_vychozi-hodnota.PNG" alt="Vstupní maska"></a>
Tato možnost do záznamu vypíše aktuální datum.</p>
<h4 id="dotazy">Dotazy</h4>
<p>Dotazy umožňují zobrazovat, přidávat, odebírat, měnit nebo filtrovat data v databázi.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_9_dotazy-1.png" alt="Dotazy; menu"></a>
Jako první se naučíme vytvářet výběrový dotaz.
Dotaz vytvoříme kliknutím na ikonku Návrh dotazu <em>v horní liště</em> na kartě vytvoření.
<em>Vybere všechny tabulky, které chceme přidat do dotazu.</em></p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_10_dotazy-2.PNG" alt="Dotazy; menu"></a></p>
<p>Například bychom chtěli zobrazit pouze vodní živočichy, vybereme tedy tabulky Zvíře, Výběh a Typ výběhu. Do dotazu chceme napsat ID zvířete, druh, jména a typ výběhu. 
Vodní živočichové v naší zoo žijí buď v akváriu, nebo ve vodní nádrži. Do kritérií zápisu tedy napíšeme tuto podmínku s uvozovkami, jelikož se jedná o přímé pojmenování výběhu. Místo slovíčka můžete také další podmínky napsat o řádek níže do kolonky nebo.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_11_dotazy-3.PNG" alt="Dotazy – výběr"></a></p>
<p>...
Pokud bycho chtěli často spouštět varianty určitého dotazu, použijeme parametrický dotaz. To znamená, <em>že se uživatele přímo zeptáme</em>, co chce vyhledat.</p>
<p>Například budeme vyhledávat zvířete podle světadílu, <em>ve kterém žijí</em>. Vytvoříme tedy <em>nový dotaz</em>, a <em>přidáme tabulky</em> Zvíře a Původ. Uživatel bude vyplňovat políčko světadílu, aby se vypsala zvířata zde žijící. Do kritérií napíšeme dotaz, kterým se budeme ptát do hranatých závorek. </p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_12_dotazy-4.PNG" alt="Dotazy – výběr"></a></p>
<p>Dotaz bude tedy vypadat takhle:</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_13_dotazy-final.png" alt="Dotazy – výběr"></a></p>
<h4 id="formul-e">Formuláře</h4>
<p>Formulář v databázi slouží k přidání, odebraní nebo úpravě dat. Formuláře bývají uživatelsky příjemně zpracované, aby do nich bylo jednoduché data zapisovat. Formuláře bývají přímo propojené se zdroji dat v databázi.
Formulář vytvoříme kliknutím na ikonku Průvodce formulářem v horní liště na kartě vytvoření</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_14_formulare.png" alt="Formuláře – menu"></a></p>
<p>V dialogovém okně vybereme tabulku, o které budeme chtít vytvořit formulář a na <em>pravou stranu</em> přesuneme všechny atributy, které chceme ve formuláři použít a dáme dokončit.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_15_formulare-2.png" alt="Formuláře – průvodce"></a></p>
<p>Otevře se nám návrh formuláře v zobrazení rozložení, lze také <em>přepnout</em> do okna návrhové zobrazení a tam formulář <em>ohezkat</em>. Můžeme přidat obrázek na pozadí, nebo změnit fonty.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_17_formular_navrh.png" alt="Formuláře – návrh"></a></p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_16_formular-vystup.png" alt="Formuláře"></a></p>
<p>Šipkou dole lze přepínat mezi formuláři a kliknutím o jedno navíc vytvoříme nový prázdný formulář, do kterého můžeme zadat nové informace.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_18_formular-dalsi.PNG" alt="Formuláře – výstup"></a></p>
<p>Tyto informace se po uložení formuláře zapíší do databáze jako nové zvíře.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_19_formular-novy.PNG" alt="Formuláře – přidání výstup"></a></p>
<h4 id="sestavy">Sestavy</h4>
<p>Sestavy slouži k vytváření seznamů a štítků. Fungují dost podobně jako formuláře, jen sestavy jsou určené <em>k tisku</em>. Sestavu vytvoříme kliknutím na ikonku Průvodce sestavou v horní liště na kartě vytvoření.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_20_sestavy-menu.png" alt="Formuláře – přidání výstup"></a></p>
<p>V dialogovém okně vybereme tabulku, pro kterou budeme chtít vytvořit sestavu a na pravou stranu přesuneme všechny atributy, které chceme v sestavě použít a dáme dokončit.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_21_sestavy-pruvodce.png" alt="Formuláře – průvodce sestavou"></a></p>
<p>Otevře se nám návrh sestavy v <em>zobrazení rozložení</em>, lze také přepnout do okna návrhové zobrazení, kde lze se <em>sestavou pracovat</em>.</p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_22_druhy-zobrazeni.png" alt="Formuláře – průvodce sestavou"></a></p>
<p><a href=""><img src="pictures/PVY_okruhy/10_databazovy-program/10_23_stitky-priklad.png" alt="Formuláře – průvodce sestavou"></a>
<code>Příklady štítků</code></p>